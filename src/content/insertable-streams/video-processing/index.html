<!DOCTYPE html>
<!--
 *  Copyright (c) 2020 The WebRTC project authors. All Rights Reserved.
 *
 *  Use of this source code is governed by a BSD-style license
 *  that can be found in the LICENSE file in the root of the source
 *  tree.
-->
<html>
<head>

    <meta charset="utf-8">
    <meta name="description" content="WebRTC code samples">
    <meta name="viewport" content="width=device-width, user-scalable=yes, initial-scale=1, maximum-scale=1">
    <meta itemprop="description" content="Client-side WebRTC code samples">
    <meta itemprop="image" content="../../../images/webrtc-icon-192x192.png">
    <meta itemprop="name" content="WebRTC code samples">
    <meta name="mobile-web-app-capable" content="yes">
    <meta id="theme-color" name="theme-color" content="#ffffff">

    <base target="_blank">

    <title>Insertable Streams - Video</title>

    <link rel="icon" sizes="192x192" href="../../../images/webrtc-icon-192x192.png">
    <link href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="../../../css/main.css"/>
    <link rel="stylesheet" href="css/main.css"/>

</head>

<body>

<div id="container">
    <h1><a href="//webrtc.github.io/samples/" title="WebRTC samples homepage">WebRTC samples</a>
        <span>Video processing with insertable streams</span></h1>

    <p>This sample shows how to perform processing on a video stream using the experimental
        <a href="https://github.com/w3c/mediacapture-insertable-streams">insertable streams</a> API.
        There are options for the source of the input stream, the destination of the output stream,
        and the API used to transform the stream. There is also the option to duplicate the source
        stream to a video element on the page, which may affect the source FPS.
    </p>

    <span id="outputVideoContainer"></span>

    <div class="box">
        <span>Source:</span>
        <select id="sourceSelector" disabled>
            <option selected value="">(stopped)</option>
            <option value="camera">Camera</option>
            <option value="video">Video</option>
            <option value="canvas">Canvas</option>
            <option value="pc">Peer connection (from camera)</option>
        </select>
        <span>Add to page: <input type="checkbox" id="sourceVisible" disabled></span>
    </div>
    <div class="box">
        <span>Transform:</span>
        <select id="transformSelector" disabled>
            <option selected value="webgl">WebGL</option>
            <option value="canvas2d">Canvas2D</option>
            <option value="noop">Do nothing</option>
            <option value="drop">Drop frames at random</option>
            <option value="delay">Delay all frames by 100ms</option>
            <option value="webcodec">Run frames through WebCodec</option>
        </select>
    </div>
    <div class="box">
        <span>Destination:</span>
        <select id="sinkSelector" disabled>
            <option selected value="video">Video</option>
            <option value="pc">Peer connection</option>
        </select>
    </div>

    <div class="box">
        <span> Video Filters : </span> <hr>
            <input type="range" id="brightnessSlider" name="brightness" min="0" max="100" value="50" class="slider">
            <label for="brightness">Brightness</label>
            <span id="brightnessSliderValue">50</span>
            <br>
            <input type="range" id="contrastSlider" name="contrast" min="0" max="100" value="50" class="slider">
            <label for="contrast">Contrast</label>
            <span id="contrastSliderValue">50</span>
            <br>
            <input type="range" id="hueSlider" name="hue" min="0" max="100" value="50" class="slider">
            <label for="hue">Hue</label>
            <span id="hueSliderValue">50</span>
            <br>
            <input type="range" id="saturationSlider" name="saturation" min="0" max="100" value="50" class="slider">
            <label for="saturation">Saturation</label>
            <span id="saturationSliderValue">50</span>
            <br>
            <input type="range" id="whitebalanceSlider" name="whitebalance" min="0" max="100" value="50" class="slider">
            <label for="whitebalance">Whitebalance</label>
            <span id="whitebalanceSliderValue">50</span>
            <br>
            <input type="range" id="denoiseSlider" name="denoise" min="0" max="100" value="50" class="slider">
            <label for="denoise">Denoise</label>
            <span id="denoiseSliderValue">50</span>
    </div>

    <p>View the console to see logging.</p>

    <p>
        <b>Note</b>: This sample is using an experimental API that has not yet been standardized.
        This API is available in Chrome 94 or later.
    </p>
    <a href="https://github.com/webrtc/samples/tree/gh-pages/src/content/insertable-streams/video-processing"
       title="View source for this page on GitHub" id="viewSource">View source on GitHub</a>

</div>

<script src="https://webrtc.github.io/adapter/adapter-latest.js"></script>
<script src="js/camera-source.js" async></script>
<script src="js/canvas-source.js" async></script>
<script src="js/canvas-transform.js" async></script>
<script src="js/peer-connection-pipe.js" async></script>
<script src="js/peer-connection-sink.js" async></script>
<script src="js/peer-connection-source.js" async></script>
<script src="js/pipeline.js" async></script>
<script src="js/simple-transforms.js" async></script>
<script src="js/video-mirror-helper.js" async></script>
<script src="js/video-sink.js" async></script>
<script src="js/video-source.js" async></script>
<script src="js/webcodec-transform.js" async></script>
<script src="js/webgl-transform.js" async></script>
<script src="js/main.js" async></script>

<script src="../../../js/lib/ga.js"></script>
</body>
</html>
